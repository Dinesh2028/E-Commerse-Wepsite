{% extends 'shop/layouts/main.html' %}

{% block title %}
{{ product.name }} - Shopkart
{% endblock title %}

{% block content %}

<section class="container" style="margin-top:70px;">
  <div class="row py-lg-4 text-center">
    <div class="col-lg-6 col-md-8 mx-auto">
      <h1 class="fw-light">{{ product.name }}</h1>
      <p class="lead text-muted">Product Details</p>
    </div>
  </div>
  <div class="row">
    <div class="col-12">
      <hr>
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
          <li class="breadcrumb-item"><a href="{% url 'collections' %}">Collections</a></li>
          <li class="breadcrumb-item active" aria-current="page" style="color: #007bff;">{{ product.name }}</li>
        </ol>
      </nav>
    </div>
  </div>
</section>

<section class="bg-light py-4 my-5">
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        {% if product.product_image %}
        <img src="{{ product.product_image.url }}" class="img-fluid" alt="{{ product.name }}">
        {% endif %}
      </div>
      <div class="col-md-6">
        <h3>{{ product.name }}</h3>
        <p class="text-muted">Vendor: {{ product.vendor }}</p>
        <p>{{ product.description }}</p>
        {% if product.original_price %}
        <p class="text-muted"><del>Original Price: ₹{{ product.original_price }}</del></p>
        {% endif %}
        <p class="text-success">Selling Price: ₹{{ product.selling_price }}</p>
        {% if product.quantity and product.quantity > 0 %}
        <p>Stock Available: {{ product.quantity }}</p>
        {% endif %}
        <p>Status: {% if product.quantity == 0 %}Coming Soon{% elif product.status %}Hidden{% else %}Available{% endif %}</p>
        {% if product.trending %}
        <span class="badge bg-primary">Trending</span>
        {% endif %}
        {% if product.quantity and product.quantity > 0 %}
          <form method="post" action="{% url 'add_to_cart' product.id %}">
            {% csrf_token %}
            <div class="mb-3">
              <label for="quantity" class="form-label">Quantity:</label>
              <div class="quantity-selector d-flex align-items-center">
                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="decrementQuantity()">-</button>
                <input type="number" id="quantity" name="quantity" class="form-control text-center mx-2" min="1" max="{{ product.quantity }}" value="1" readonly style="width: 80px;">
                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="incrementQuantity()">+</button>
              </div>
            </div>
            <button type="submit" class="btn btn-primary mt-3">Add to Cart</button>
          </form>
          <script>
            function incrementQuantity() {
              const input = document.getElementById('quantity');
              const max = parseInt(input.max);
              let value = parseInt(input.value);
              if (value < max) {
                input.value = value + 1;
              }
            }
            function decrementQuantity() {
              const input = document.getElementById('quantity');
              let value = parseInt(input.value);
              if (value > 1) {
                input.value = value - 1;
              }
            }
          </script>
        {% else %}
          <p class="text-danger mt-3">Out of Stock</p>
        {% endif %}
      </div>
    </div>
  </div>
</section>

{% endblock content %}
